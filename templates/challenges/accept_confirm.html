{% extends 'base.html' %}
{% block title %}Accept Challenge{% endblock %}
{% block content %}
<div class="container py-5">
<div class="row justify-content-center">
  <div class="col-12 col-md-8 col-lg-6">
    <div class="card" style="background: linear-gradient(135deg, rgba(255,153,0,0.05) 0%, rgba(255,153,0,0.02) 100%); border: 1px solid rgba(255,153,0,0.2);">
      <div class="card-header" style="background: rgba(40,167,69,0.1); border-bottom: 1px solid #28a745;">
        <h5 class="card-title mb-0" style="color: var(--sh-white);"><i class="fas fa-handshake me-2" style="color: #28a745;"></i>Accept Challenge</h5>
      </div>
      <div class="card-body">
        <div class="alert" style="background: rgba(255,153,0,0.1); border: 1px solid rgba(255,153,0,0.3); color: var(--sh-white);">
          <i class="fas fa-info-circle me-2" style="color: var(--sh-orange);"></i>
          <strong>You are about to accept this challenge!</strong> Once accepted, the challenge cannot be cancelled.
        </div>
        
        <h6 class="text-tcc mb-3">Challenge Details:</h6>
        <div class="mb-3">
          <p><strong>Creator:</strong> {{ challenge.creator.username }}</p>
          <p><strong>Type:</strong> {{ challenge.get_challenge_type_display }}</p>
          <p><strong>Description:</strong> {{ challenge.condition_text|default:'No description' }}</p>
          <p><strong>Status:</strong> <span class="badge bg-warning">{{ challenge.status }}</span></p>
          {% if challenge.scheduled_at %}
          <p><strong>Scheduled:</strong> {{ challenge.scheduled_at|date:'M d, Y H:i' }}</p>
          {% endif %}
          {% if challenge.ground %}
          <p><strong>Location:</strong> {{ challenge.ground.name }}</p>
          {% endif %}
        </div>
        
        <div class="alert" style="background: rgba(255,193,7,0.1); border: 1px solid rgba(255,193,7,0.3); color: var(--sh-white);">
          <i class="fas fa-exclamation-triangle me-2" style="color: #ffc107;"></i>
          <strong>Important:</strong> Make sure you understand the challenge requirements and are available for the scheduled time.
        </div>
        
        <form method="post">
          {% csrf_token %}
          
          <!-- Challenge Rules Agreement -->
          <div class="mb-4">
            <div class="form-check">
              <input class="form-check-input challenge-rules-checkbox" type="checkbox" id="challenge_rules" name="challenge_rules" required>
              <label class="form-check-label text-white" for="challenge_rules">
                I have read and agree to the <a href="{% url 'challenge_rules' %}" target="_blank" class="text-decoration-none" style="color: var(--sh-orange);">Challenge Rules & Guidelines</a>
              </label>
            </div>
          </div>
          
          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-success" id="submitBtn" disabled>
              <i class="fas fa-check me-2"></i>Yes, Accept Challenge
            </button>
            <a href="{% url 'challenge_detail' challenge.id %}" class="btn btn-outline-tcc">
              <i class="fas fa-times me-2"></i>Cancel
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>
  </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const rulesCheckbox = document.getElementById('challenge_rules');
    const submitBtn = document.getElementById('submitBtn');
    
    if (rulesCheckbox && submitBtn) {
        // Enable/disable submit button based on checkbox state
        rulesCheckbox.addEventListener('change', function() {
            if (this.checked) {
                submitBtn.disabled = false;
                submitBtn.style.opacity = '1';
                // Add a subtle animation to the button
                submitBtn.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    submitBtn.style.transform = 'scale(1)';
                }, 200);
            } else {
                submitBtn.disabled = true;
                submitBtn.style.opacity = '0.6';
            }
        });
        
        // Form validation
        const form = document.querySelector('form');
        form.addEventListener('submit', function(e) {
            if (!rulesCheckbox.checked) {
                e.preventDefault();
                alert('You must agree to the Challenge Rules & Guidelines to accept this challenge.');
                return false;
            }
        });
        
        // Add click animation to checkbox
        rulesCheckbox.addEventListener('click', function() {
            if (!this.checked) {
                // Add a subtle bounce effect when checking
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 100);
            }
        });
    }
});
</script>

<style>
/* Challenge Rules Checkbox Animation */
.challenge-rules-checkbox {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    width: 20px !important;
    height: 20px !important;
    border: 2px solid var(--sh-orange) !important;
    border-radius: 4px !important;
    background-color: #000000 !important;
    position: relative !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    margin-right: 8px !important;
    vertical-align: middle !important;
}

.challenge-rules-checkbox:hover {
    border-color: var(--sh-orange) !important;
    box-shadow: 0 0 0 2px rgba(255, 153, 0, 0.2) !important;
    transform: scale(1.05) !important;
}

.challenge-rules-checkbox:focus {
    outline: none !important;
    border-color: var(--sh-orange) !important;
    box-shadow: 0 0 0 3px rgba(255, 153, 0, 0.3) !important;
}

.challenge-rules-checkbox:checked {
    background-color: var(--sh-orange) !important;
    border-color: var(--sh-orange) !important;
    animation: checkboxFill 0.4s ease-in-out !important;
}

.challenge-rules-checkbox:checked::after {
    content: 'âœ“' !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    color: #ffffff !important;
    font-weight: bold !important;
    font-size: 12px !important;
    text-shadow: 0 0 2px rgba(0, 0, 0, 0.5) !important;
    animation: checkmarkAppear 0.3s ease-in-out 0.1s both !important;
}

@keyframes checkboxFill {
    0% {
        background-color: #000000;
        transform: scale(1);
    }
    50% {
        background-color: rgba(255, 153, 0, 0.5);
        transform: scale(1.1);
    }
    100% {
        background-color: var(--sh-orange);
        transform: scale(1);
    }
}

@keyframes checkmarkAppear {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5);
    }
    100% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
}

/* Submit button animation */
#submitBtn {
    transition: all 0.3s ease !important;
}

#submitBtn:disabled {
    opacity: 0.6 !important;
    transform: scale(0.98) !important;
}

#submitBtn:not(:disabled) {
    opacity: 1 !important;
    transform: scale(1) !important;
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3) !important;
}

#submitBtn:not(:disabled):hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4) !important;
}
</style>
{% endblock %}
